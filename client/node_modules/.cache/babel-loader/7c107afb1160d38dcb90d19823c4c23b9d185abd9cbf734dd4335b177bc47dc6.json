{"ast":null,"code":"var _jsxFileName = \"/home/kierans/code/session-spawner/client/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { lazy, useEffect, useState, useCallback } from 'react';\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap/dist/css/bootstrap-grid.min.css';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Container = /*#__PURE__*/lazy(_c = () => import('react-bootstrap/Container'));\n_c2 = Container;\nconst Row = /*#__PURE__*/lazy(_c3 = () => import('react-bootstrap/Row'));\n_c4 = Row;\nconst Col = /*#__PURE__*/lazy(_c5 = () => import('react-bootstrap/Col'));\n_c6 = Col;\nconst YesSessionHome = /*#__PURE__*/React.lazy(_c7 = () => import('./NoSessionHome'));\n_c8 = YesSessionHome;\nconst NoSessionHome = /*#__PURE__*/React.lazy(_c9 = () => import('./NoSessionHome'));\n_c10 = NoSessionHome;\naxios.defaults.withCredentials = true;\nfunction App() {\n  _s();\n  const [userId, setUserId] = useState(null);\n  const [expiry, setExpiry] = useState(null);\n  const [sessionActive, setSessionActive] = useState(false);\n  const API_BASE_URL = process.env.API_URL;\n  const startSession = async () => {\n    try {\n      await axios.get(`${API_BASE_URL}/sessions/create`);\n      setSessionActive(true);\n    } catch (error) {\n      console.error('Error creating session:', error);\n    }\n  };\n  const killSession = useCallback(async () => {\n    try {\n      await axios.get(`${API_BASE_URL}/sessions/destroy`);\n      setSessionActive(false);\n    } catch (error) {\n      console.error('Error deleting session:', error);\n    }\n  }, [setSessionActive, API_BASE_URL]);\n  useEffect(() => {\n    const fetchUserId = async () => {\n      try {\n        if (sessionActive) {\n          const index_response = await axios.get(`${API_BASE_URL}/`);\n          const userId = index_response.data;\n\n          // Kill the session if it lingers without a userId for whatever reason. \n          if (!userId) {\n            killSession();\n          }\n          const get_expiry_response = await axios.get(`${API_BASE_URL}/get_expiry`);\n          const expiry = get_expiry_response.data;\n          setExpiry(expiry);\n          setUserId(userId);\n          localStorage.setItem('userId', userId);\n          localStorage.setItem('expires', expiry);\n          console.log(userId + \", \" + sessionActive);\n        } else {\n          setUserId(null);\n          setExpiry(null);\n          localStorage.removeItem('userId');\n          localStorage.removeItem('expires');\n        }\n      } catch (error) {\n        console.error('Error fetching user ID:', error);\n      }\n    };\n    const intervalId = setInterval(() => {\n      fetchUserId();\n    }, 1000);\n\n    // Cleanup function: clear the interval when the component unmounts\n    return () => clearInterval(intervalId);\n  }, [killSession, sessionActive, setSessionActive, API_BASE_URL]);\n  const MemoizedNoSessionHome = /*#__PURE__*/React.memo(NoSessionHome);\n  const MemoizedYesSessionHome = /*#__PURE__*/React.memo(YesSessionHome);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"flex-container p-3\",\n    style: {\n      height: '100vh',\n      textAlign: 'center',\n      marginTop: '5rem'\n    },\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        className: \"col-md-12\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Session Spawner\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), sessionActive ? ((() => {\n        console.log('Active');\n        return null;\n      })(), /*#__PURE__*/_jsxDEV(MemoizedYesSessionHome, {\n        userId: userId,\n        expiry: expiry,\n        setExpiry: setExpiry,\n        startSession: startSession,\n        killSession: killSession\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this)) : ((() => {\n        console.log('Inactive');\n        return null;\n      })(), /*#__PURE__*/_jsxDEV(MemoizedNoSessionHome, {\n        startSession: startSession,\n        killSession: killSession\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n\n// Hot Module Replacement\n_s(App, \"KJsnZ1M/xeZ0B06bMI9ob+e3O3U=\");\n_c11 = App;\nif (module.hot) {\n  module.hot.accept();\n}\nexport default App;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11;\n$RefreshReg$(_c, \"Container$lazy\");\n$RefreshReg$(_c2, \"Container\");\n$RefreshReg$(_c3, \"Row$lazy\");\n$RefreshReg$(_c4, \"Row\");\n$RefreshReg$(_c5, \"Col$lazy\");\n$RefreshReg$(_c6, \"Col\");\n$RefreshReg$(_c7, \"YesSessionHome$React.lazy\");\n$RefreshReg$(_c8, \"YesSessionHome\");\n$RefreshReg$(_c9, \"NoSessionHome$React.lazy\");\n$RefreshReg$(_c10, \"NoSessionHome\");\n$RefreshReg$(_c11, \"App\");","map":{"version":3,"names":["React","lazy","useEffect","useState","useCallback","axios","jsxDEV","_jsxDEV","Container","_c","_c2","Row","_c3","_c4","Col","_c5","_c6","YesSessionHome","_c7","_c8","NoSessionHome","_c9","_c10","defaults","withCredentials","App","_s","userId","setUserId","expiry","setExpiry","sessionActive","setSessionActive","API_BASE_URL","process","env","API_URL","startSession","get","error","console","killSession","fetchUserId","index_response","data","get_expiry_response","localStorage","setItem","log","removeItem","intervalId","setInterval","clearInterval","MemoizedNoSessionHome","memo","MemoizedYesSessionHome","className","style","height","textAlign","marginTop","children","fileName","_jsxFileName","lineNumber","columnNumber","_c11","module","hot","accept","$RefreshReg$"],"sources":["/home/kierans/code/session-spawner/client/src/App.js"],"sourcesContent":["import React, { lazy, useEffect, useState, useCallback } from 'react';\nimport axios from 'axios';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap/dist/css/bootstrap-grid.min.css';\nimport './App.css';\nconst Container = lazy(() => import('react-bootstrap/Container'));\nconst Row = lazy(() => import('react-bootstrap/Row'));\nconst Col = lazy(() => import('react-bootstrap/Col'));\nconst YesSessionHome = React.lazy(() => import('./NoSessionHome'));\nconst NoSessionHome = React.lazy(() => import('./NoSessionHome'));\n\naxios.defaults.withCredentials = true;\n\nfunction App() {\n  const [userId, setUserId] = useState(null);\n  const [expiry, setExpiry] = useState(null);\n  const [sessionActive, setSessionActive] = useState(false);\n\n  const API_BASE_URL = process.env.API_URL;\n\n  const startSession = async () => {\n    try {\n      await axios.get(`${API_BASE_URL}/sessions/create`);\n      setSessionActive(true);\n    } catch (error) {\n      console.error('Error creating session:', error);\n    }\n  };  \n\n  const killSession = useCallback(async () => {\n    try {\n      await axios.get(`${API_BASE_URL}/sessions/destroy`);\n      setSessionActive(false);\n    } catch (error) {\n      console.error('Error deleting session:', error);\n    }\n  }, [setSessionActive, API_BASE_URL]);\n\n  useEffect(() => {\n    const fetchUserId = async () => {\n      try {\n        if (sessionActive) {\n          const index_response = await axios.get(`${API_BASE_URL}/`);\n          const userId = index_response.data;\n\n          // Kill the session if it lingers without a userId for whatever reason. \n          if (!userId) {\n            killSession();\n          }\n\n          const get_expiry_response = await axios.get(`${API_BASE_URL}/get_expiry`);\n          const expiry = get_expiry_response.data;\n\n          setExpiry(expiry);\n          setUserId(userId);\n          localStorage.setItem('userId', userId);\n          localStorage.setItem('expires', expiry);\n\n          console.log(userId + \", \" + sessionActive);\n        } else {\n          setUserId(null);\n          setExpiry(null);\n          localStorage.removeItem('userId');\n          localStorage.removeItem('expires');\n        }\n      } catch (error) {\n        console.error('Error fetching user ID:', error);\n      }\n    };\n\n    const intervalId = setInterval(() => {\n      fetchUserId();\n    }, 1000);\n\n    // Cleanup function: clear the interval when the component unmounts\n    return () => clearInterval(intervalId);\n  }, [killSession, sessionActive, setSessionActive, API_BASE_URL]);\n\n  const MemoizedNoSessionHome = React.memo(NoSessionHome);\n  const MemoizedYesSessionHome = React.memo(YesSessionHome);\n\n  return (\n    <Container className=\"flex-container p-3\" style={{ height: '100vh', textAlign: 'center', marginTop: '5rem' }}>\n      <Row>\n        <Col className=\"col-md-12\">\n          <h1>Session Spawner</h1>\n        </Col>\n        {sessionActive ? (\n          (() => { console.log('Active'); return null; })(),\n          <MemoizedYesSessionHome userId={userId} expiry={expiry} setExpiry={setExpiry} startSession={startSession} killSession={killSession} />\n        ) : (\n          (() => { console.log('Inactive'); return null; })(),\n          <MemoizedNoSessionHome startSession={startSession} killSession={killSession} />\n        )}\n      </Row>\n    </Container>\n  );\n}\n\n// Hot Module Replacement\nif (module.hot) {\n  module.hot.accept();\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}